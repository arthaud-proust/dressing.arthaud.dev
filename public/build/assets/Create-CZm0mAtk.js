import{a as n,c as p,h as d,d as N,y as O,u as P,w as z,z as R,F as B,s as F,t as y,r as $,A as D,l as S,B as T,g as a,k as M,C as A,n as q,b as L,e as x,f as m,T as E,Z as H,i as G,j as J}from"./app-Dx26qlXV.js";import{_ as j}from"./VButton.vue_vue_type_script_setup_true_lang-D51bOqsU.js";import{_ as K}from"./VInput.vue_vue_type_script_setup_true_lang-QYCJZ-3d.js";import{u as Q,a as W,_ as X}from"./NoLayout.vue_vue_type_script_setup_true_lang-S_It9hZt.js";import{_ as Z}from"./InputError.vue_vue_type_script_setup_true_lang-CSY0_wNj.js";import{_ as Y}from"./VPageHeader.vue_vue_type_script_setup_true_lang-fmw-Xnf0.js";import{u as ee}from"./useClothesCategories-DPHyWEB8.js";import{r as te}from"./PlusIcon-DaiYcN6F.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";function ae(i,s){return n(),p("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[d("path",{"fill-rule":"evenodd",d:"M4.755 10.059a7.5 7.5 0 0 1 12.548-3.364l1.903 1.903h-3.183a.75.75 0 1 0 0 1.5h4.992a.75.75 0 0 0 .75-.75V4.356a.75.75 0 0 0-1.5 0v3.18l-1.9-1.9A9 9 0 0 0 3.306 9.67a.75.75 0 1 0 1.45.388Zm15.408 3.352a.75.75 0 0 0-.919.53 7.5 7.5 0 0 1-12.548 3.364l-1.902-1.903h3.183a.75.75 0 0 0 0-1.5H2.984a.75.75 0 0 0-.75.75v4.992a.75.75 0 0 0 1.5 0v-3.18l1.9 1.9a9 9 0 0 0 15.059-4.035.75.75 0 0 0-.53-.918Z","clip-rule":"evenodd"})])}function se(i,s){return n(),p("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[d("path",{d:"M12 9a3.75 3.75 0 1 0 0 7.5A3.75 3.75 0 0 0 12 9Z"}),d("path",{"fill-rule":"evenodd",d:"M9.344 3.071a49.52 49.52 0 0 1 5.312 0c.967.052 1.83.585 2.332 1.39l.821 1.317c.24.383.645.643 1.11.71.386.054.77.113 1.152.177 1.432.239 2.429 1.493 2.429 2.909V18a3 3 0 0 1-3 3h-15a3 3 0 0 1-3-3V9.574c0-1.416.997-2.67 2.429-2.909.382-.064.766-.123 1.151-.178a1.56 1.56 0 0 0 1.11-.71l.822-1.315a2.942 2.942 0 0 1 2.332-1.39ZM6.75 12.75a5.25 5.25 0 1 1 10.5 0 5.25 5.25 0 0 1-10.5 0Zm12-1.5a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Z","clip-rule":"evenodd"})])}function oe(i,s){return n(),p("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[d("path",{"fill-rule":"evenodd",d:"M5.47 5.47a.75.75 0 0 1 1.06 0L12 10.94l5.47-5.47a.75.75 0 1 1 1.06 1.06L13.06 12l5.47 5.47a.75.75 0 1 1-1.06 1.06L12 13.06l-5.47 5.47a.75.75 0 0 1-1.06-1.06L10.94 12 5.47 6.53a.75.75 0 0 1 0-1.06Z","clip-rule":"evenodd"})])}const le=["disabled"],re=["value"],ne=N({__name:"VSelect",props:O({options:{},disabled:{type:Boolean}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(i){const s=P(i,"modelValue");return(o,l)=>z((n(),p("select",{disabled:o.disabled,"onUpdate:modelValue":l[0]||(l[0]=t=>s.value=t),class:"flex items-center justify-center gap-1 rounded-lg px-4 py-2 ring-offset-2 focus:outline-none focus:ring-4 disabled:pointer-events-none disabled:opacity-50"},[(n(!0),p(B,null,F(o.options,t=>(n(),p("option",{value:t.value},y(t.label),9,re))),256))],8,le)),[[R,s.value]])}}),ie=({onCamerasUpdated:i,onStream:s})=>{const o=$(-1),{videoInputs:l}=Q({requestPermissions:!0}),t=$(!1),v=$();let u=null;D(l,c=>{console.log(c),i&&i(c)});const f=S(()=>l.value[o.value]),r=()=>new Promise((c,k)=>{var U;h(),t.value=!0;const V={audio:!1,video:{deviceId:(U=f.value)==null?void 0:U.deviceId}};navigator.mediaDevices.getUserMedia(V).then(C=>{u=C,s&&s(C),c()}).catch(C=>{v.value=C,console.error(C),k(C)}).finally(()=>{t.value=!1})}),h=()=>u==null?void 0:u.getTracks().forEach(c=>c.stop()),e=async c=>{c<0||l.value.length<=c?o.value=0:o.value=c,await r()},w=()=>e(o.value+1),g=S(()=>l.value.length>1),b=c=>{var k,V;return c&&(((k=c.label)==null?void 0:k.includes("rear"))||((V=c.label)==null?void 0:V.includes("back")))},_=async()=>await e(l.value.findIndex(b)),I=S(()=>!b(f.value));return{canSelectNextCamera:g,selectCamera:e,selectRearCamera:_,selectNextCamera:w,startCameraStream:r,stopCameraStream:h,isLoading:t,error:v,isSelectedCameraMirrored:I}},ce=i=>{const s=document.createElement("canvas"),o=s.getContext("2d");return{captureFrame:async t=>new Promise((v,u)=>{var h;if(!i.value)return u("No video element");const f=i.value.srcObject;if(!(f instanceof MediaStream))return u("Video srcObject is not a MediaStream");const r=(h=f.getVideoTracks()[0])==null?void 0:h.getSettings();if(!r.width||!r.height)return u("No stream size");if(!o)return u("No context 2d for canvas");s.height=r.height,s.width=r.width,t&&(o.translate(s.width,0),o.scale(-1,1)),o.drawImage(i.value,0,0,r.width,r.height,0,0,r.width,r.height),s.toBlob(e=>v(e))})}},de={class:"relative w-fit overflow-hidden rounded-md bg-black"},ue={key:0,class:"inset-0 mx-auto object-cover"},me={class:"absolute bottom-0 z-20 flex w-full flex-row items-end justify-center gap-4 p-4"},pe={key:0,class:"rounded-lg bg-red-100 p-4 text-red-600"},ve=N({__name:"Camera",emits:["photo"],setup(i,{emit:s}){const o=s,l=$(),{isLoading:t,error:v,selectNextCamera:u,selectRearCamera:f,canSelectNextCamera:r,stopCameraStream:h,isSelectedCameraMirrored:e}=ie({onCamerasUpdated:()=>{f()},onStream:_=>{l.value&&(l.value.srcObject=_)}}),{captureFrame:w}=ce(l),g=async()=>{await u()},b=async()=>{const _=await w(e.value);_&&o("photo",_)};return T(()=>{h()}),(_,I)=>(n(),p("div",de,[a(t)?(n(),p("div",ue)):M("",!0),z(d("video",{ref_key:"cameraOutputRef",ref:l,class:q(["mx-auto h-full object-contain object-center",a(e)&&"-scale-x-100"]),autoplay:"",muted:""},null,2),[[A,!a(t)]]),d("div",me,[a(v)?(n(),p("div",pe,y(_.$t("impossible_daccder_la_camra")),1)):M("",!0),a(v)?M("",!0):(n(),L(j,{key:1,icon:"",type:"button",onClick:b},{default:x(()=>[m(a(se),{class:"size-6"})]),_:1})),!a(v)&&a(r)?(n(),L(j,{key:2,icon:"",variant:"secondary",type:"button",onClick:g},{default:x(()=>[m(a(ae),{class:"size-6"})]),_:1})):M("",!0)])]))}}),fe={class:"flex max-h-[40dvh] justify-center"},he={class:"flex justify-center"},ge={class:"relative h-full overflow-hidden rounded-md"},_e=["src"],Se=N({__name:"Create",props:{dressing:{}},setup(i){const s=i,o=ee(),l=W("dressing.clothes.create",o.options[0].value),t=E({images:[],description:"",clothes_category_id:l.value}),v=S({get:()=>t.clothes_category_id,set:e=>{l.value=e,t.clothes_category_id=e}}),u=()=>{t.post(route("dressings.clothes.store",s.dressing),{preserveState:!1})},f=e=>{t.images.push(e)},r=e=>{t.images.splice(e,1)},h=e=>(window.URL||window.webkitURL).createObjectURL(e);return $(1),(e,w)=>(n(),p(B,null,[m(a(H),{title:e.$t("dashboard")},null,8,["title"]),m(X,null,{header:x(()=>[m(Y,{"back-to":e.route("dressings.show",e.dressing),title:e.$t("ajouter_un_vtement_au_dressing",{dressing:e.dressing.name})},null,8,["back-to","title"])]),default:x(()=>[d("form",{class:"mx-auto flex h-min max-w-lg flex-col gap-4",onSubmit:J(u,["prevent"])},[d("div",null,[d("label",null,y(e.$t("catgorie")),1),m(ne,{modelValue:v.value,"onUpdate:modelValue":w[0]||(w[0]=g=>v.value=g),options:a(o).options,class:"w-full"},null,8,["modelValue","options"]),m(Z,{message:a(t).errors.description,class:"mt-2"},null,8,["message"])]),d("div",null,[d("label",null,y(e.$t("description"))+" ("+y(e.$t("optionnel"))+")",1),m(K,{modelValue:a(t).description,"onUpdate:modelValue":w[1]||(w[1]=g=>a(t).description=g),placeholder:e.$t("pull_gris"),class:"w-full"},null,8,["modelValue","placeholder"]),m(Z,{message:a(t).errors.description,class:"mt-2"},null,8,["message"])]),d("div",fe,[a(t).images.length?(n(!0),p(B,{key:0},F(a(t).images,(g,b)=>(n(),p("div",he,[d("div",ge,[d("img",{class:"h-full object-contain",src:h(g),alt:""},null,8,_e),m(j,{icon:"",small:"",class:"absolute right-1 top-1",variant:"danger",onClick:_=>r(b)},{default:x(()=>[m(a(oe),{class:"h-5 w-5"})]),_:2},1032,["onClick"])])]))),256)):(n(),L(ve,{key:1,class:"mx-auto",onPhoto:f}))]),m(j,{type:"submit",disabled:a(t).processing,loading:a(t).processing},{default:x(()=>[G(y(e.$t("ajouter_le_vtement"))+" ",1),m(a(te),{class:"size-5"})]),_:1},8,["disabled","loading"])],32)]),_:1})],64))}});export{Se as default};
